<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Neural Streak ‚Äî R√©entra√Æne ton cerveau</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Space+Mono:wght@400;700&family=Syne:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        :root {
            --bg-primary: #0a0a0f;
            --bg-secondary: #12121a;
            --bg-card: #1a1a24;
            --accent-cyan: #00f5d4;
            --accent-magenta: #f72585;
            --accent-yellow: #fee440;
            --accent-purple: #7b2cbf;
            --accent-orange: #ff6b35;
            --text-primary: #ffffff;
            --text-secondary: #8a8a9a;
            --text-muted: #4a4a5a;
            --gradient-neural: linear-gradient(135deg, #00f5d4 0%, #7b2cbf 50%, #f72585 100%);
            --font-display: 'Syne', sans-serif;
            --font-mono: 'Space Mono', monospace;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        html, body, #root { height: 100%; width: 100%; }
        body {
            font-family: var(--font-display);
            background: var(--bg-primary);
            color: var(--text-primary);
            overflow-x: hidden;
        }
        @keyframes float { 0%, 100% { transform: translateY(0px); } 50% { transform: translateY(-20px); } }
        @keyframes pulse-glow { 0%, 100% { box-shadow: 0 0 20px rgba(0, 245, 212, 0.3); } 50% { box-shadow: 0 0 40px rgba(0, 245, 212, 0.6); } }
        @keyframes gradient-shift { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }
        @keyframes fade-in-up { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes scale-in { from { opacity: 0; transform: scale(0.8); } to { opacity: 1; transform: scale(1); } }
        @keyframes shake { 0%, 100% { transform: translateX(0); } 25% { transform: translateX(-10px); } 75% { transform: translateX(10px); } }
        @keyframes neuron-pulse { 0%, 100% { opacity: 0.3; transform: scale(1); } 50% { opacity: 1; transform: scale(1.2); } }
        .animate-fade-in { animation: fade-in-up 0.6s ease-out forwards; }
        .animate-scale-in { animation: scale-in 0.4s ease-out forwards; }
        .animate-shake { animation: shake 0.4s ease-in-out; }
        .gradient-text {
            background: var(--gradient-neural);
            background-size: 200% 200%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: gradient-shift 3s ease infinite;
        }
        .glass-card {
            background: rgba(26, 26, 36, 0.8);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.05);
            border-radius: 24px;
        }
        .btn-primary {
            background: var(--gradient-neural);
            background-size: 200% 200%;
            border: none;
            padding: 16px 40px;
            border-radius: 50px;
            font-family: var(--font-display);
            font-weight: 700;
            font-size: 1.1rem;
            color: var(--bg-primary);
            cursor: pointer;
            transition: all 0.3s ease;
            animation: gradient-shift 3s ease infinite;
        }
        .btn-primary:hover { transform: translateY(-3px); box-shadow: 0 10px 40px rgba(0, 245, 212, 0.4); }
        .btn-secondary {
            background: transparent;
            border: 2px solid var(--accent-cyan);
            padding: 14px 36px;
            border-radius: 50px;
            font-family: var(--font-display);
            font-weight: 600;
            font-size: 1rem;
            color: var(--accent-cyan);
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .btn-secondary:hover { background: var(--accent-cyan); color: var(--bg-primary); }
        .noise-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none; opacity: 0.03; z-index: 9999;
            background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.85' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E");
        }
        .grid-bg {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-image: linear-gradient(rgba(0, 245, 212, 0.03) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0, 245, 212, 0.03) 1px, transparent 1px);
            background-size: 50px 50px;
            pointer-events: none; z-index: 0;
        }
    </style>
</head>
<body>
    <div class="noise-overlay"></div>
    <div class="grid-bg"></div>
    <div id="root"></div>
    <script type="text/babel">
        const { useState, useEffect, useCallback } = React;
        
        const COLORS = { cyan: '#00f5d4', magenta: '#f72585', yellow: '#fee440', purple: '#7b2cbf', orange: '#ff6b35' };
        const COLOR_NAMES = Object.keys(COLORS);
        
        const ONBOARDING_SLIDES = [
            { title: "Ton cerveau s'atrophie.", subtitle: "Et c'est prouv√© scientifiquement.", stat: "8.25s", statLabel: "C'est ton attention span moyen. Moins qu'un poisson rouge.", source: "Microsoft Research", icon: "üß†" },
            { title: "L'IA pense √† ta place.", subtitle: "√âtude MIT Media Lab 2025", stat: "-40%", statLabel: "de connectivit√© c√©r√©brale chez les utilisateurs intensifs de ChatGPT", source: "MIT Media Lab, 2025", icon: "ü§ñ" },
            { title: "Tu perds ta m√©moire.", subtitle: "Le 'Google Effect' amplifi√© par l'IA", stat: "72%", statLabel: "des participants ne pouvaient plus citer leur propre travail", source: "Gerlich, 2025 ‚Äî Cognitive Offloading Study", icon: "üíæ" },
            { title: "Les jeunes sont les plus touch√©s.", subtitle: "Corr√©lation n√©gative entre usage IA et pens√©e critique", stat: "17-25", statLabel: "ans : la tranche d'√¢ge la plus d√©pendante avec les scores les plus bas", source: "Societies Journal, Jan 2025", icon: "üìâ" },
            { title: "Neural Streak inverse la tendance.", subtitle: "5 minutes par jour pour r√©activer tes circuits", stat: "6", statLabel: "fonctions cognitives cibl√©es : m√©moire, attention, logique, rappel, ex√©cution, m√©tacognition", source: null, icon: "‚ö°" }
        ];

        const GAME_MODES = [
            { id: 'memory', name: 'M√©moire S√©quentielle', description: 'M√©morise la s√©quence de couleurs', icon: 'üé®', color: COLORS.cyan, targetFunction: 'Working Memory' },
            { id: 'reaction', name: 'Go / No-Go', description: 'Tape si vert, ignore si rouge', icon: '‚ö°', color: COLORS.yellow, targetFunction: 'Executive Function' },
            { id: 'pattern', name: 'Pattern Logic', description: 'Trouve le pattern suivant', icon: 'üß©', color: COLORS.purple, targetFunction: 'Critical Thinking' },
            { id: 'recall', name: 'Rappel Diff√©r√©', description: 'M√©morise puis rappelle apr√®s d√©lai', icon: 'üí≠', color: COLORS.magenta, targetFunction: 'Memory Encoding' },
            { id: 'focus', name: 'Focus Soutenu', description: 'D√©tecte les changements subtils', icon: 'üëÅÔ∏è', color: COLORS.orange, targetFunction: 'Sustained Attention' }
        ];

        const shuffle = arr => { const a = [...arr]; for (let i = a.length - 1; i > 0; i--) { const j = Math.floor(Math.random() * (i + 1)); [a[i], a[j]] = [a[j], a[i]]; } return a; };
        const getRandomColor = () => COLOR_NAMES[Math.floor(Math.random() * COLOR_NAMES.length)];
        const generateSequence = length => Array.from({ length }, () => getRandomColor());
        const sleep = ms => new Promise(resolve => setTimeout(resolve, ms));

        const NeuronBackground = () => {
            const neurons = Array.from({ length: 12 }, (_, i) => ({
                id: i, left: Math.random() * 100, top: Math.random() * 100,
                delay: Math.random() * 5, duration: 3 + Math.random() * 4, size: 4 + Math.random() * 8
            }));
            return (
                <div style={{ position: 'fixed', top: 0, left: 0, width: '100%', height: '100%', pointerEvents: 'none', zIndex: 1, overflow: 'hidden' }}>
                    {neurons.map(n => (
                        <div key={n.id} style={{
                            position: 'absolute', left: `${n.left}%`, top: `${n.top}%`,
                            width: n.size, height: n.size, borderRadius: '50%',
                            background: `rgba(0, 245, 212, 0.${Math.floor(Math.random() * 5) + 2})`,
                            animation: `neuron-pulse ${n.duration}s ease-in-out infinite`,
                            animationDelay: `${n.delay}s`
                        }} />
                    ))}
                </div>
            );
        };

        const OnboardingScreen = ({ onComplete }) => {
            const [currentSlide, setCurrentSlide] = useState(0);
            const slide = ONBOARDING_SLIDES[currentSlide];
            const nextSlide = () => currentSlide < ONBOARDING_SLIDES.length - 1 ? setCurrentSlide(prev => prev + 1) : onComplete();
            
            return (
                <div style={{ minHeight: '100vh', display: 'flex', flexDirection: 'column', alignItems: 'center', justifyContent: 'center', padding: '40px 20px', position: 'relative', zIndex: 10 }}>
                    <NeuronBackground />
                    <div style={{ display: 'flex', gap: 12, marginBottom: 60 }}>
                        {ONBOARDING_SLIDES.map((_, i) => (
                            <div key={i} style={{ width: i === currentSlide ? 32 : 10, height: 10, borderRadius: 5, background: i === currentSlide ? COLORS.cyan : 'rgba(255,255,255,0.2)', transition: 'all 0.3s ease' }} />
                        ))}
                    </div>
                    <div key={`icon-${currentSlide}`} className="animate-scale-in" style={{ fontSize: '5rem', marginBottom: 30, filter: 'drop-shadow(0 0 30px rgba(0, 245, 212, 0.5))' }}>{slide.icon}</div>
                    <h1 key={`title-${currentSlide}`} className="animate-fade-in" style={{ fontFamily: 'var(--font-display)', fontSize: 'clamp(2rem, 6vw, 3.5rem)', fontWeight: 800, textAlign: 'center', marginBottom: 16, lineHeight: 1.1 }}>{slide.title}</h1>
                    <p key={`sub-${currentSlide}`} className="animate-fade-in" style={{ fontFamily: 'var(--font-mono)', fontSize: '1rem', color: 'var(--text-secondary)', textAlign: 'center', marginBottom: 50, animationDelay: '0.1s' }}>{slide.subtitle}</p>
                    <div key={`stat-${currentSlide}`} className="glass-card animate-fade-in" style={{ padding: '40px 50px', textAlign: 'center', maxWidth: 400, animationDelay: '0.2s' }}>
                        <div className="gradient-text" style={{ fontFamily: 'var(--font-display)', fontSize: '4rem', fontWeight: 800, lineHeight: 1 }}>{slide.stat}</div>
                        <p style={{ fontFamily: 'var(--font-mono)', fontSize: '0.9rem', color: 'var(--text-secondary)', marginTop: 16, lineHeight: 1.5 }}>{slide.statLabel}</p>
                        {slide.source && <p style={{ fontFamily: 'var(--font-mono)', fontSize: '0.75rem', color: 'var(--text-muted)', marginTop: 20, fontStyle: 'italic' }}>Source: {slide.source}</p>}
                    </div>
                    <button className="btn-primary" onClick={nextSlide} style={{ marginTop: 50 }}>{currentSlide === ONBOARDING_SLIDES.length - 1 ? "Commencer l'entra√Ænement" : "Continuer"}</button>
                    {currentSlide < ONBOARDING_SLIDES.length - 1 && <button onClick={onComplete} style={{ background: 'none', border: 'none', color: 'var(--text-muted)', fontFamily: 'var(--font-mono)', fontSize: '0.85rem', marginTop: 20, cursor: 'pointer' }}>Passer l'intro ‚Üí</button>}
                    <a href="https://www.mdpi.com/2075-4698/15/1/6" target="_blank" rel="noopener noreferrer" style={{ position: 'fixed', bottom: 20, right: 20, fontFamily: 'var(--font-mono)', fontSize: '0.7rem', color: 'var(--text-muted)', textDecoration: 'none', opacity: 0.5 }}>üìö Voir les √©tudes</a>
                </div>
            );
        };

        const AuthScreen = ({ onAuth }) => {
            const [email, setEmail] = useState('');
            const [isLoading, setIsLoading] = useState(false);
            const handleSubmit = e => { e.preventDefault(); if (!email) return; setIsLoading(true); setTimeout(() => { localStorage.setItem('neural_user', JSON.stringify({ email, streak: 0, totalScore: 0 })); onAuth({ email }); }, 800); };
            const handleGoogleAuth = () => { setIsLoading(true); setTimeout(() => { const mockEmail = 'user@gmail.com'; localStorage.setItem('neural_user', JSON.stringify({ email: mockEmail, streak: 0, totalScore: 0 })); onAuth({ email: mockEmail }); }, 800); };
            
            return (
                <div style={{ minHeight: '100vh', display: 'flex', flexDirection: 'column', alignItems: 'center', justifyContent: 'center', padding: '40px 20px', position: 'relative', zIndex: 10 }}>
                    <NeuronBackground />
                    <div style={{ marginBottom: 20 }}><span style={{ fontSize: '4rem' }}>üß†</span></div>
                    <h1 className="gradient-text" style={{ fontFamily: 'var(--font-display)', fontSize: 'clamp(2.5rem, 8vw, 4rem)', fontWeight: 800, marginBottom: 16 }}>Neural Streak</h1>
                    <p style={{ fontFamily: 'var(--font-mono)', fontSize: '1rem', color: 'var(--text-secondary)', marginBottom: 50, textAlign: 'center' }}>R√©entra√Æne ton cerveau. 5 min/jour.</p>
                    <div className="glass-card" style={{ padding: '40px', width: '100%', maxWidth: 400 }}>
                        <button onClick={handleGoogleAuth} disabled={isLoading} style={{ width: '100%', padding: '16px', borderRadius: 12, border: '1px solid rgba(255,255,255,0.1)', background: 'rgba(255,255,255,0.05)', color: 'white', fontFamily: 'var(--font-display)', fontSize: '1rem', fontWeight: 600, cursor: 'pointer', display: 'flex', alignItems: 'center', justifyContent: 'center', gap: 12, opacity: isLoading ? 0.5 : 1 }}>
                            <svg width="20" height="20" viewBox="0 0 24 24"><path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/><path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/><path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/><path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/></svg>
                            Continuer avec Google
                        </button>
                        <div style={{ display: 'flex', alignItems: 'center', margin: '24px 0', gap: 16 }}>
                            <div style={{ flex: 1, height: 1, background: 'rgba(255,255,255,0.1)' }} />
                            <span style={{ fontFamily: 'var(--font-mono)', fontSize: '0.8rem', color: 'var(--text-muted)' }}>ou</span>
                            <div style={{ flex: 1, height: 1, background: 'rgba(255,255,255,0.1)' }} />
                        </div>
                        <form onSubmit={handleSubmit}>
                            <input type="email" placeholder="ton@email.com" value={email} onChange={e => setEmail(e.target.value)} style={{ width: '100%', padding: '16px', borderRadius: 12, border: '1px solid rgba(255,255,255,0.1)', background: 'rgba(0,0,0,0.3)', color: 'white', fontFamily: 'var(--font-mono)', fontSize: '1rem', marginBottom: 16, outline: 'none' }} />
                            <button type="submit" className="btn-primary" disabled={isLoading || !email} style={{ width: '100%', opacity: isLoading || !email ? 0.5 : 1 }}>{isLoading ? 'Chargement...' : 'Commencer'}</button>
                        </form>
                    </div>
                    <p style={{ fontFamily: 'var(--font-mono)', fontSize: '0.75rem', color: 'var(--text-muted)', marginTop: 30, textAlign: 'center' }}>En continuant, tu acceptes de r√©entra√Æner ton cerveau üß†</p>
                </div>
            );
        };

        const DashboardScreen = ({ user, onSelectMode, onLogout }) => {
            const [userData, setUserData] = useState(() => { const saved = localStorage.getItem('neural_user'); return saved ? JSON.parse(saved) : { streak: 0, totalScore: 0, lastPlayed: null }; });
            const today = new Date().toDateString();
            const playedToday = userData.lastPlayed === today;

            return (
                <div style={{ minHeight: '100vh', padding: '40px 20px', position: 'relative', zIndex: 10 }}>
                    <NeuronBackground />
                    <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', maxWidth: 800, margin: '0 auto 40px' }}>
                        <h1 style={{ fontFamily: 'var(--font-display)', fontSize: '1.5rem', fontWeight: 700, display: 'flex', alignItems: 'center', gap: 10 }}>üß† <span className="gradient-text">Neural Streak</span></h1>
                        <button onClick={onLogout} style={{ background: 'none', border: 'none', color: 'var(--text-muted)', fontFamily: 'var(--font-mono)', fontSize: '0.85rem', cursor: 'pointer' }}>D√©connexion</button>
                    </div>
                    <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(150px, 1fr))', gap: 20, maxWidth: 800, margin: '0 auto 50px' }}>
                        <div className="glass-card" style={{ padding: '24px', textAlign: 'center' }}>
                            <div style={{ fontSize: '2.5rem', fontWeight: 800, color: COLORS.cyan }}>üî• {userData.streak}</div>
                            <div style={{ fontFamily: 'var(--font-mono)', fontSize: '0.8rem', color: 'var(--text-secondary)', marginTop: 8 }}>jours de streak</div>
                        </div>
                        <div className="glass-card" style={{ padding: '24px', textAlign: 'center' }}>
                            <div style={{ fontSize: '2.5rem', fontWeight: 800, color: COLORS.yellow }}>{userData.totalScore}</div>
                            <div style={{ fontFamily: 'var(--font-mono)', fontSize: '0.8rem', color: 'var(--text-secondary)', marginTop: 8 }}>points totaux</div>
                        </div>
                        <div className="glass-card" style={{ padding: '24px', textAlign: 'center', background: playedToday ? 'rgba(0, 245, 212, 0.1)' : 'rgba(247, 37, 133, 0.1)' }}>
                            <div style={{ fontSize: '2.5rem' }}>{playedToday ? '‚úÖ' : '‚è∞'}</div>
                            <div style={{ fontFamily: 'var(--font-mono)', fontSize: '0.8rem', color: 'var(--text-secondary)', marginTop: 8 }}>{playedToday ? "Jou√© aujourd'hui" : 'Pas encore jou√©'}</div>
                        </div>
                    </div>
                    <div style={{ maxWidth: 800, margin: '0 auto' }}>
                        <h2 style={{ fontFamily: 'var(--font-display)', fontSize: '1.3rem', fontWeight: 700, marginBottom: 24, color: 'var(--text-secondary)' }}>Choisis ton entra√Ænement</h2>
                        <div style={{ display: 'grid', gap: 16 }}>
                            {GAME_MODES.map((mode, index) => (
                                <button key={mode.id} onClick={() => onSelectMode(mode)} className="glass-card animate-fade-in" style={{ padding: '24px', display: 'flex', alignItems: 'center', gap: 20, cursor: 'pointer', border: 'none', textAlign: 'left', transition: 'all 0.3s ease', animationDelay: `${index * 0.1}s`, animationFillMode: 'backwards' }}>
                                    <div style={{ width: 60, height: 60, borderRadius: 16, background: `${mode.color}22`, display: 'flex', alignItems: 'center', justifyContent: 'center', fontSize: '2rem', flexShrink: 0 }}>{mode.icon}</div>
                                    <div style={{ flex: 1 }}>
                                        <h3 style={{ fontFamily: 'var(--font-display)', fontSize: '1.2rem', fontWeight: 700, color: 'white', marginBottom: 6 }}>{mode.name}</h3>
                                        <p style={{ fontFamily: 'var(--font-mono)', fontSize: '0.85rem', color: 'var(--text-secondary)' }}>{mode.description}</p>
                                        <span style={{ fontFamily: 'var(--font-mono)', fontSize: '0.7rem', color: mode.color, marginTop: 8, display: 'inline-block' }}>‚Ü≥ {mode.targetFunction}</span>
                                    </div>
                                    <div style={{ color: 'var(--text-muted)', fontSize: '1.5rem' }}>‚Üí</div>
                                </button>
                            ))}
                        </div>
                    </div>
                    <a href="https://www.mdpi.com/2075-4698/15/1/6" target="_blank" rel="noopener noreferrer" style={{ position: 'fixed', bottom: 20, right: 20, fontFamily: 'var(--font-mono)', fontSize: '0.7rem', color: 'var(--text-muted)', textDecoration: 'none', opacity: 0.5 }}>üìö √âtudes scientifiques</a>
                </div>
            );
        };

        const ResultScreen = ({ score, level, mode, extraStats, onBack, onRetry }) => {
            useEffect(() => {
                const userData = JSON.parse(localStorage.getItem('neural_user') || '{}');
                const today = new Date().toDateString();
                const wasPlayedToday = userData.lastPlayed === today;
                const newStreak = wasPlayedToday ? userData.streak : (userData.streak || 0) + 1;
                localStorage.setItem('neural_user', JSON.stringify({ ...userData, streak: newStreak, totalScore: (userData.totalScore || 0) + score, lastPlayed: today }));
            }, [score]);
            const shareText = `üß† Neural Streak - J'ai scor√© ${score} points !\nR√©entra√Æne ton cerveau ‚Üí`;
            const handleShare = () => { navigator.clipboard?.writeText(shareText); alert('Copi√© !'); };
            
            return (
                <div style={{ minHeight: '100vh', display: 'flex', flexDirection: 'column', alignItems: 'center', justifyContent: 'center', padding: '40px 20px', position: 'relative', zIndex: 10 }}>
                    <NeuronBackground />
                    <div className="animate-scale-in" style={{ fontSize: '5rem', marginBottom: 20 }}>{score >= 100 ? 'üèÜ' : score >= 50 ? 'üéØ' : 'üí™'}</div>
                    <h1 className="gradient-text" style={{ fontFamily: 'var(--font-display)', fontSize: 'clamp(2rem, 6vw, 3rem)', fontWeight: 800, marginBottom: 10 }}>{score >= 100 ? 'Incroyable !' : score >= 50 ? 'Bien jou√© !' : 'Continue !'}</h1>
                    <div className="glass-card animate-fade-in" style={{ padding: '40px', marginTop: 30, marginBottom: 30, textAlign: 'center', minWidth: 280 }}>
                        <div style={{ fontSize: '4rem', fontWeight: 800, color: COLORS.yellow, lineHeight: 1 }}>{score}</div>
                        <div style={{ fontFamily: 'var(--font-mono)', fontSize: '1rem', color: 'var(--text-secondary)', marginTop: 8 }}>points</div>
                        {extraStats && (
                            <div style={{ marginTop: 20, paddingTop: 20, borderTop: '1px solid rgba(255,255,255,0.1)' }}>
                                {extraStats.avgReaction && <p style={{ fontFamily: 'var(--font-mono)', fontSize: '0.9rem', color: 'var(--text-secondary)' }}>‚ö° Temps moyen: {extraStats.avgReaction}ms</p>}
                                {extraStats.recalled !== undefined && <p style={{ fontFamily: 'var(--font-mono)', fontSize: '0.9rem', color: 'var(--text-secondary)' }}>üí≠ Mots rappel√©s: {extraStats.recalled}/{extraStats.total}</p>}
                            </div>
                        )}
                    </div>
                    <div style={{ display: 'flex', gap: 16, flexWrap: 'wrap', justifyContent: 'center' }}>
                        <button className="btn-primary" onClick={onRetry}>Rejouer</button>
                        <button className="btn-secondary" onClick={handleShare}>Partager üì§</button>
                    </div>
                    <button onClick={onBack} style={{ marginTop: 30, background: 'none', border: 'none', color: 'var(--text-muted)', fontFamily: 'var(--font-mono)', fontSize: '0.9rem', cursor: 'pointer' }}>‚Üê Retour au menu</button>
                </div>
            );
        };

        const MemoryGame = ({ onBack }) => {
            const [phase, setPhase] = useState('ready');
            const [sequence, setSequence] = useState([]);
            const [userSequence, setUserSequence] = useState([]);
            const [level, setLevel] = useState(1);
            const [activeColor, setActiveColor] = useState(null);
            const [score, setScore] = useState(0);
            const [showingIndex, setShowingIndex] = useState(-1);
            const [feedback, setFeedback] = useState(null);
            const [lives, setLives] = useState(3);

            const startLevel = useCallback(async () => {
                const newSequence = generateSequence(level + 2);
                setSequence(newSequence);
                setUserSequence([]);
                setPhase('showing');
                setFeedback(null);
                for (let i = 0; i < newSequence.length; i++) {
                    await sleep(300);
                    setShowingIndex(i);
                    setActiveColor(newSequence[i]);
                    await sleep(500);
                    setActiveColor(null);
                }
                setShowingIndex(-1);
                setPhase('input');
            }, [level]);

            useEffect(() => { if (phase === 'ready') { const timer = setTimeout(startLevel, 1000); return () => clearTimeout(timer); } }, [phase, startLevel]);

            const handleColorClick = color => {
                if (phase !== 'input') return;
                const newUserSequence = [...userSequence, color];
                setUserSequence(newUserSequence);
                setActiveColor(color);
                setTimeout(() => setActiveColor(null), 150);
                const currentIndex = newUserSequence.length - 1;
                if (newUserSequence[currentIndex] !== sequence[currentIndex]) {
                    setFeedback('wrong');
                    setLives(prev => prev - 1);
                    if (lives <= 1) setPhase('result');
                    else setTimeout(() => setPhase('ready'), 1000);
                    return;
                }
                if (newUserSequence.length === sequence.length) {
                    setFeedback('correct');
                    setScore(prev => prev + level * 10);
                    setTimeout(() => { setLevel(prev => prev + 1); setPhase('ready'); }, 1000);
                }
            };

            if (phase === 'result') return <ResultScreen score={score} level={level} mode="memory" onBack={onBack} onRetry={() => { setLevel(1); setScore(0); setLives(3); setPhase('ready'); }} />;

            return (
                <div style={{ minHeight: '100vh', display: 'flex', flexDirection: 'column', alignItems: 'center', justifyContent: 'center', padding: '40px 20px', position: 'relative', zIndex: 10 }}>
                    <NeuronBackground />
                    <button onClick={onBack} style={{ position: 'absolute', top: 20, left: 20, background: 'none', border: 'none', color: 'var(--text-secondary)', fontFamily: 'var(--font-mono)', fontSize: '1rem', cursor: 'pointer' }}>‚Üê Retour</button>
                    <div style={{ display: 'flex', gap: 30, marginBottom: 40 }}>
                        <div style={{ textAlign: 'center' }}><div style={{ fontFamily: 'var(--font-mono)', fontSize: '0.8rem', color: 'var(--text-muted)' }}>NIVEAU</div><div style={{ fontSize: '2rem', fontWeight: 800, color: COLORS.cyan }}>{level}</div></div>
                        <div style={{ textAlign: 'center' }}><div style={{ fontFamily: 'var(--font-mono)', fontSize: '0.8rem', color: 'var(--text-muted)' }}>SCORE</div><div style={{ fontSize: '2rem', fontWeight: 800, color: COLORS.yellow }}>{score}</div></div>
                        <div style={{ textAlign: 'center' }}><div style={{ fontFamily: 'var(--font-mono)', fontSize: '0.8rem', color: 'var(--text-muted)' }}>VIES</div><div style={{ fontSize: '2rem', fontWeight: 800, color: COLORS.magenta }}>{'‚ù§Ô∏è'.repeat(lives)}</div></div>
                    </div>
                    <div style={{ fontFamily: 'var(--font-mono)', fontSize: '1rem', color: 'var(--text-secondary)', marginBottom: 40, textAlign: 'center' }}>
                        {phase === 'ready' && 'Pr√©pare-toi...'}{phase === 'showing' && `M√©morise ! (${showingIndex + 1}/${sequence.length})`}{phase === 'input' && `√Ä toi ! (${userSequence.length}/${sequence.length})`}
                    </div>
                    <div className={feedback === 'wrong' ? 'animate-shake' : ''} style={{ display: 'grid', gridTemplateColumns: 'repeat(3, 1fr)', gap: 16, maxWidth: 320 }}>
                        {COLOR_NAMES.map(colorName => (
                            <button key={colorName} onClick={() => handleColorClick(colorName)} disabled={phase !== 'input'} style={{
                                width: 90, height: 90, borderRadius: 20, border: 'none', background: COLORS[colorName],
                                cursor: phase === 'input' ? 'pointer' : 'default', transition: 'all 0.15s ease',
                                transform: activeColor === colorName ? 'scale(1.1)' : 'scale(1)',
                                boxShadow: activeColor === colorName ? `0 0 40px ${COLORS[colorName]}` : 'none',
                                opacity: phase === 'showing' && activeColor !== colorName ? 0.3 : 1
                            }} />
                        ))}
                    </div>
                    {feedback && <div style={{ marginTop: 30, fontFamily: 'var(--font-display)', fontSize: '1.5rem', fontWeight: 700, color: feedback === 'correct' ? COLORS.cyan : COLORS.magenta }}>{feedback === 'correct' ? '‚úì Parfait !' : '‚úó Rat√© !'}</div>}
                </div>
            );
        };

        const ReactionGame = ({ onBack }) => {
            const [phase, setPhase] = useState('ready');
            const [currentColor, setCurrentColor] = useState(null);
            const [score, setScore] = useState(0);
            const [round, setRound] = useState(0);
            const [feedback, setFeedback] = useState(null);
            const [reactionTimes, setReactionTimes] = useState([]);
            const [roundStartTime, setRoundStartTime] = useState(null);
            const [mistakes, setMistakes] = useState(0);
            const totalRounds = 15;

            const startRound = useCallback(() => {
                if (round >= totalRounds) { setPhase('result'); return; }
                setFeedback(null); setCurrentColor(null); setPhase('waiting');
                const delay = 1000 + Math.random() * 2000;
                setTimeout(() => {
                    const isGo = Math.random() > 0.3;
                    setCurrentColor(isGo ? 'go' : 'nogo');
                    setRoundStartTime(Date.now());
                    setPhase('active');
                }, delay);
            }, [round, totalRounds]);

            useEffect(() => { if (phase === 'ready') { const timer = setTimeout(startRound, 1500); return () => clearTimeout(timer); } }, [phase, startRound]);
            useEffect(() => {
                if (phase === 'active') {
                    const timeout = setTimeout(() => {
                        if (currentColor === 'go') { setFeedback('missed'); setMistakes(prev => prev + 1); }
                        else { setFeedback('correct-ignore'); setScore(prev => prev + 5); }
                        setTimeout(() => { setRound(prev => prev + 1); setPhase('ready'); }, 600);
                    }, 1500);
                    return () => clearTimeout(timeout);
                }
            }, [phase, currentColor]);

            const handleTap = () => {
                if (phase !== 'active') return;
                const reactionTime = Date.now() - roundStartTime;
                if (currentColor === 'go') {
                    const points = Math.max(1, Math.floor(20 - reactionTime / 50));
                    setScore(prev => prev + points);
                    setReactionTimes(prev => [...prev, reactionTime]);
                    setFeedback('correct');
                } else { setFeedback('wrong'); setMistakes(prev => prev + 1); }
                setPhase('feedback');
                setTimeout(() => { setRound(prev => prev + 1); setPhase('ready'); }, 600);
            };

            if (phase === 'result') {
                const avgReaction = reactionTimes.length > 0 ? Math.round(reactionTimes.reduce((a, b) => a + b, 0) / reactionTimes.length) : 0;
                return <ResultScreen score={score} level={totalRounds - mistakes} mode="reaction" extraStats={{ avgReaction, mistakes }} onBack={onBack} onRetry={() => { setRound(0); setScore(0); setMistakes(0); setReactionTimes([]); setPhase('ready'); }} />;
            }

            return (
                <div onClick={handleTap} style={{ minHeight: '100vh', display: 'flex', flexDirection: 'column', alignItems: 'center', justifyContent: 'center', padding: '40px 20px', position: 'relative', zIndex: 10, cursor: phase === 'active' ? 'pointer' : 'default' }}>
                    <NeuronBackground />
                    <button onClick={e => { e.stopPropagation(); onBack(); }} style={{ position: 'absolute', top: 20, left: 20, background: 'none', border: 'none', color: 'var(--text-secondary)', fontFamily: 'var(--font-mono)', fontSize: '1rem', cursor: 'pointer' }}>‚Üê Retour</button>
                    <div style={{ display: 'flex', gap: 30, marginBottom: 40 }}>
                        <div style={{ textAlign: 'center' }}><div style={{ fontFamily: 'var(--font-mono)', fontSize: '0.8rem', color: 'var(--text-muted)' }}>ROUND</div><div style={{ fontSize: '2rem', fontWeight: 800, color: COLORS.cyan }}>{round + 1}/{totalRounds}</div></div>
                        <div style={{ textAlign: 'center' }}><div style={{ fontFamily: 'var(--font-mono)', fontSize: '0.8rem', color: 'var(--text-muted)' }}>SCORE</div><div style={{ fontSize: '2rem', fontWeight: 800, color: COLORS.yellow }}>{score}</div></div>
                    </div>
                    <div style={{ fontFamily: 'var(--font-mono)', fontSize: '1rem', color: 'var(--text-secondary)', marginBottom: 20, textAlign: 'center' }}>üü¢ Vert = TAPE &nbsp;&nbsp; üî¥ Rouge = IGNORE</div>
                    <div className={feedback === 'wrong' || feedback === 'missed' ? 'animate-shake' : ''} style={{
                        width: 200, height: 200, borderRadius: '50%',
                        background: currentColor === 'go' ? COLORS.cyan : currentColor === 'nogo' ? COLORS.magenta : 'var(--bg-card)',
                        display: 'flex', alignItems: 'center', justifyContent: 'center', transition: 'all 0.1s ease',
                        boxShadow: currentColor ? `0 0 60px ${currentColor === 'go' ? COLORS.cyan : COLORS.magenta}` : 'none'
                    }}>
                        {phase === 'waiting' && <span style={{ fontFamily: 'var(--font-mono)', fontSize: '1rem', color: 'var(--text-muted)' }}>Attends...</span>}
                        {phase === 'active' && <span style={{ fontSize: '3rem', color: 'var(--bg-primary)' }}>{currentColor === 'go' ? 'GO!' : 'NO'}</span>}
                    </div>
                    {feedback && <div style={{ marginTop: 30, fontFamily: 'var(--font-display)', fontSize: '1.2rem', fontWeight: 700, color: feedback.includes('correct') ? COLORS.cyan : COLORS.magenta }}>
                        {feedback === 'correct' && '‚úì Rapide !'}{feedback === 'correct-ignore' && '‚úì Bien ignor√© !'}{feedback === 'wrong' && '‚úó Fallait ignorer !'}{feedback === 'missed' && '‚úó Trop lent !'}
                    </div>}
                </div>
            );
        };

        const PatternGame = ({ onBack }) => {
            const [phase, setPhase] = useState('playing');
            const [level, setLevel] = useState(1);
            const [score, setScore] = useState(0);
            const [currentPattern, setCurrentPattern] = useState([]);
            const [options, setOptions] = useState([]);
            const [correctAnswer, setCorrectAnswer] = useState(null);
            const [feedback, setFeedback] = useState(null);
            const [lives, setLives] = useState(3);

            const generatePattern = useCallback(() => {
                const start = Math.floor(Math.random() * 10) + 1;
                const step = Math.floor(Math.random() * 5) + 1;
                const pattern = Array.from({ length: 4 }, (_, i) => start + step * i);
                const answer = start + step * 4;
                const wrongOptions = [answer + Math.floor(Math.random() * 5) + 1, answer - Math.floor(Math.random() * 5) - 1, answer + Math.floor(Math.random() * 10) + 5].filter(o => o !== answer && o > 0);
                setCurrentPattern(pattern);
                setOptions(shuffle([answer, ...wrongOptions.slice(0, 3)]));
                setCorrectAnswer(answer);
                setFeedback(null);
            }, [level]);

            useEffect(() => { generatePattern(); }, [generatePattern]);

            const handleAnswer = answer => {
                if (feedback) return;
                if (answer === correctAnswer) {
                    setFeedback('correct'); setScore(prev => prev + level * 15);
                    setTimeout(() => { setLevel(prev => prev + 1); generatePattern(); }, 1000);
                } else {
                    setFeedback('wrong'); setLives(prev => prev - 1);
                    if (lives <= 1) setTimeout(() => setPhase('result'), 1000);
                    else setTimeout(generatePattern, 1000);
                }
            };

            if (phase === 'result') return <ResultScreen score={score} level={level} mode="pattern" onBack={onBack} onRetry={() => { setLevel(1); setScore(0); setLives(3); setPhase('playing'); }} />;

            return (
                <div style={{ minHeight: '100vh', display: 'flex', flexDirection: 'column', alignItems: 'center', justifyContent: 'center', padding: '40px 20px', position: 'relative', zIndex: 10 }}>
                    <NeuronBackground />
                    <button onClick={onBack} style={{ position: 'absolute', top: 20, left: 20, background: 'none', border: 'none', color: 'var(--text-secondary)', fontFamily: 'var(--font-mono)', fontSize: '1rem', cursor: 'pointer' }}>‚Üê Retour</button>
                    <div style={{ display: 'flex', gap: 30, marginBottom: 40 }}>
                        <div style={{ textAlign: 'center' }}><div style={{ fontFamily: 'var(--font-mono)', fontSize: '0.8rem', color: 'var(--text-muted)' }}>NIVEAU</div><div style={{ fontSize: '2rem', fontWeight: 800, color: COLORS.purple }}>{level}</div></div>
                        <div style={{ textAlign: 'center' }}><div style={{ fontFamily: 'var(--font-mono)', fontSize: '0.8rem', color: 'var(--text-muted)' }}>SCORE</div><div style={{ fontSize: '2rem', fontWeight: 800, color: COLORS.yellow }}>{score}</div></div>
                        <div style={{ textAlign: 'center' }}><div style={{ fontFamily: 'var(--font-mono)', fontSize: '0.8rem', color: 'var(--text-muted)' }}>VIES</div><div style={{ fontSize: '2rem', fontWeight: 800, color: COLORS.magenta }}>{'‚ù§Ô∏è'.repeat(lives)}</div></div>
                    </div>
                    <h2 style={{ fontFamily: 'var(--font-display)', fontSize: '1.2rem', fontWeight: 600, color: 'var(--text-secondary)', marginBottom: 30 }}>Trouve le nombre suivant</h2>
                    <div className={`glass-card ${feedback === 'wrong' ? 'animate-shake' : ''}`} style={{ padding: '30px 40px', marginBottom: 40, display: 'flex', alignItems: 'center', gap: 20 }}>
                        {currentPattern.map((num, i) => (
                            <React.Fragment key={i}>
                                <span style={{ fontFamily: 'var(--font-mono)', fontSize: '2rem', fontWeight: 700, color: 'white' }}>{num}</span>
                                {i < currentPattern.length - 1 && <span style={{ color: 'var(--text-muted)' }}>‚Üí</span>}
                            </React.Fragment>
                        ))}
                        <span style={{ color: 'var(--text-muted)' }}>‚Üí</span>
                        <span style={{ fontFamily: 'var(--font-mono)', fontSize: '2rem', fontWeight: 700, color: COLORS.purple }}>?</span>
                    </div>
                    <div style={{ display: 'grid', gridTemplateColumns: 'repeat(2, 1fr)', gap: 16, maxWidth: 300 }}>
                        {options.map((option, i) => (
                            <button key={i} onClick={() => handleAnswer(option)} disabled={!!feedback} style={{
                                padding: '20px 30px', borderRadius: 16,
                                border: feedback && option === correctAnswer ? `3px solid ${COLORS.cyan}` : '2px solid rgba(255,255,255,0.1)',
                                background: feedback && option === correctAnswer ? `${COLORS.cyan}22` : 'var(--bg-card)',
                                fontFamily: 'var(--font-mono)', fontSize: '1.5rem', fontWeight: 700, color: 'white', cursor: feedback ? 'default' : 'pointer'
                            }}>{option}</button>
                        ))}
                    </div>
                    {feedback && <div style={{ marginTop: 30, fontFamily: 'var(--font-display)', fontSize: '1.5rem', fontWeight: 700, color: feedback === 'correct' ? COLORS.cyan : COLORS.magenta }}>{feedback === 'correct' ? '‚úì Excellent !' : `‚úó C'√©tait ${correctAnswer}`}</div>}
                </div>
            );
        };

        const RecallGame = ({ onBack }) => {
            const [phase, setPhase] = useState('memorize');
            const [words, setWords] = useState([]);
            const [timer, setTimer] = useState(10);
            const [userInput, setUserInput] = useState('');
            const [results, setResults] = useState(null);
            const [level, setLevel] = useState(1);
            const [totalScore, setTotalScore] = useState(0);
            const wordLists = [['soleil', 'montagne', 'oc√©an', 'for√™t', '√©toile'], ['cerveau', 'm√©moire', 'neurone', 'synapse', 'cortex'], ['bitcoin', 'blockchain', 'crypto', 'wallet', 'mining']];

            useEffect(() => { const randomList = wordLists[Math.floor(Math.random() * wordLists.length)]; setWords(shuffle(randomList).slice(0, 3 + level)); }, [level]);
            useEffect(() => {
                if ((phase === 'memorize' || phase === 'distraction') && timer > 0) {
                    const interval = setInterval(() => setTimer(prev => prev - 1), 1000);
                    return () => clearInterval(interval);
                } else if (phase === 'memorize' && timer === 0) { setPhase('distraction'); setTimer(5); }
                else if (phase === 'distraction' && timer === 0) { setPhase('recall'); }
            }, [phase, timer]);

            const checkRecall = () => {
                const inputWords = userInput.toLowerCase().split(/[\s,]+/).filter(w => w.length > 0);
                const correct = inputWords.filter(w => words.includes(w));
                const score = correct.length * 20;
                setResults({ correct: correct.length, total: words.length, score });
                setTotalScore(prev => prev + score);
                setPhase('result');
            };

            if (phase === 'result' && results) {
                if (results.correct === results.total && level < 5) {
                    return (
                        <div style={{ minHeight: '100vh', display: 'flex', flexDirection: 'column', alignItems: 'center', justifyContent: 'center', padding: '40px 20px', position: 'relative', zIndex: 10 }}>
                            <NeuronBackground />
                            <div className="animate-scale-in" style={{ fontSize: '4rem', marginBottom: 20 }}>üéâ</div>
                            <h2 className="gradient-text" style={{ fontFamily: 'var(--font-display)', fontSize: '2rem', fontWeight: 800, marginBottom: 20 }}>Parfait !</h2>
                            <p style={{ fontFamily: 'var(--font-mono)', color: 'var(--text-secondary)', marginBottom: 30 }}>{results.correct}/{results.total} mots rappel√©s</p>
                            <button className="btn-primary" onClick={() => { setLevel(prev => prev + 1); setTimer(10); setUserInput(''); setResults(null); setPhase('memorize'); }}>Niveau suivant ‚Üí</button>
                        </div>
                    );
                }
                return <ResultScreen score={totalScore} level={level} mode="recall" extraStats={{ recalled: results.correct, total: results.total }} onBack={onBack} onRetry={() => { setLevel(1); setTotalScore(0); setTimer(10); setUserInput(''); setResults(null); setPhase('memorize'); }} />;
            }

            return (
                <div style={{ minHeight: '100vh', display: 'flex', flexDirection: 'column', alignItems: 'center', justifyContent: 'center', padding: '40px 20px', position: 'relative', zIndex: 10 }}>
                    <NeuronBackground />
                    <button onClick={onBack} style={{ position: 'absolute', top: 20, left: 20, background: 'none', border: 'none', color: 'var(--text-secondary)', fontFamily: 'var(--font-mono)', fontSize: '1rem', cursor: 'pointer' }}>‚Üê Retour</button>
                    <div style={{ width: 100, height: 100, borderRadius: '50%', border: `4px solid ${phase === 'distraction' ? COLORS.magenta : COLORS.cyan}`, display: 'flex', alignItems: 'center', justifyContent: 'center', marginBottom: 30 }}>
                        <span style={{ fontFamily: 'var(--font-mono)', fontSize: '2.5rem', fontWeight: 700, color: phase === 'distraction' ? COLORS.magenta : COLORS.cyan }}>{timer}</span>
                    </div>
                    {phase === 'memorize' && (
                        <>
                            <h2 style={{ fontFamily: 'var(--font-display)', fontSize: '1.5rem', fontWeight: 700, marginBottom: 30, color: 'var(--text-secondary)' }}>M√©morise ces {words.length} mots</h2>
                            <div className="glass-card" style={{ padding: '30px 40px', display: 'flex', flexWrap: 'wrap', gap: 16, justifyContent: 'center', maxWidth: 400 }}>
                                {words.map((word, i) => <span key={i} className="animate-fade-in" style={{ fontFamily: 'var(--font-mono)', fontSize: '1.3rem', fontWeight: 600, color: COLORS.cyan, animationDelay: `${i * 0.1}s` }}>{word}</span>)}
                            </div>
                        </>
                    )}
                    {phase === 'distraction' && (
                        <>
                            <h2 style={{ fontFamily: 'var(--font-display)', fontSize: '1.5rem', fontWeight: 700, marginBottom: 30, color: COLORS.magenta }}>üßÆ Calcule !</h2>
                            <div className="glass-card" style={{ padding: '30px 40px', textAlign: 'center' }}>
                                <p style={{ fontFamily: 'var(--font-mono)', fontSize: '1.5rem', color: 'white' }}>{Math.floor(Math.random() * 50) + 10} + {Math.floor(Math.random() * 30) + 5} = ?</p>
                                <p style={{ fontFamily: 'var(--font-mono)', fontSize: '0.9rem', color: 'var(--text-muted)', marginTop: 16 }}>(distraction intentionnelle)</p>
                            </div>
                        </>
                    )}
                    {phase === 'recall' && (
                        <>
                            <h2 style={{ fontFamily: 'var(--font-display)', fontSize: '1.5rem', fontWeight: 700, marginBottom: 30, color: 'var(--text-secondary)' }}>Quels √©taient les mots ?</h2>
                            <div style={{ width: '100%', maxWidth: 400 }}>
                                <textarea value={userInput} onChange={e => setUserInput(e.target.value)} placeholder="Tape les mots s√©par√©s par des espaces..." style={{ width: '100%', height: 120, padding: 20, borderRadius: 16, border: '2px solid rgba(255,255,255,0.1)', background: 'var(--bg-card)', color: 'white', fontFamily: 'var(--font-mono)', fontSize: '1rem', resize: 'none', outline: 'none' }} autoFocus />
                                <button className="btn-primary" onClick={checkRecall} style={{ width: '100%', marginTop: 20 }}>V√©rifier</button>
                            </div>
                        </>
                    )}
                </div>
            );
        };

        const FocusGame = ({ onBack }) => {
            const [phase, setPhase] = useState('playing');
            const [grid, setGrid] = useState([]);
            const [changingCell, setChangingCell] = useState(null);
            const [score, setScore] = useState(0);
            const [round, setRound] = useState(1);
            const [feedback, setFeedback] = useState(null);
            const [lives, setLives] = useState(3);
            const gridSize = 16;

            const generateGrid = useCallback(() => {
                const colors = [COLORS.cyan, COLORS.magenta, COLORS.yellow, COLORS.purple];
                const newGrid = Array.from({ length: gridSize }, () => colors[Math.floor(Math.random() * colors.length)]);
                setGrid(newGrid); setChangingCell(null); setFeedback(null);
                setTimeout(() => { setChangingCell(Math.floor(Math.random() * gridSize)); }, 1500 + Math.random() * 2000);
            }, []);

            useEffect(() => { generateGrid(); }, [round]);

            const handleCellClick = index => {
                if (feedback) return;
                if (index === changingCell) {
                    setFeedback('correct'); setScore(prev => prev + 25);
                    setTimeout(() => { setRound(prev => prev + 1); if (round >= 10) setPhase('result'); }, 800);
                } else {
                    setFeedback('wrong'); setLives(prev => prev - 1);
                    if (lives <= 1) setTimeout(() => setPhase('result'), 800);
                    else setTimeout(() => setRound(prev => prev + 1), 800);
                }
            };

            if (phase === 'result') return <ResultScreen score={score} level={round} mode="focus" onBack={onBack} onRetry={() => { setRound(1); setScore(0); setLives(3); setPhase('playing'); }} />;

            return (
                <div style={{ minHeight: '100vh', display: 'flex', flexDirection: 'column', alignItems: 'center', justifyContent: 'center', padding: '40px 20px', position: 'relative', zIndex: 10 }}>
                    <NeuronBackground />
                    <button onClick={onBack} style={{ position: 'absolute', top: 20, left: 20, background: 'none', border: 'none', color: 'var(--text-secondary)', fontFamily: 'var(--font-mono)', fontSize: '1rem', cursor: 'pointer' }}>‚Üê Retour</button>
                    <div style={{ display: 'flex', gap: 30, marginBottom: 30 }}>
                        <div style={{ textAlign: 'center' }}><div style={{ fontFamily: 'var(--font-mono)', fontSize: '0.8rem', color: 'var(--text-muted)' }}>ROUND</div><div style={{ fontSize: '2rem', fontWeight: 800, color: COLORS.orange }}>{round}/10</div></div>
                        <div style={{ textAlign: 'center' }}><div style={{ fontFamily: 'var(--font-mono)', fontSize: '0.8rem', color: 'var(--text-muted)' }}>SCORE</div><div style={{ fontSize: '2rem', fontWeight: 800, color: COLORS.yellow }}>{score}</div></div>
                        <div style={{ textAlign: 'center' }}><div style={{ fontFamily: 'var(--font-mono)', fontSize: '0.8rem', color: 'var(--text-muted)' }}>VIES</div><div style={{ fontSize: '2rem', fontWeight: 800, color: COLORS.magenta }}>{'‚ù§Ô∏è'.repeat(lives)}</div></div>
                    </div>
                    <h2 style={{ fontFamily: 'var(--font-display)', fontSize: '1.2rem', fontWeight: 600, color: 'var(--text-secondary)', marginBottom: 30, textAlign: 'center' }}>üëÅÔ∏è Clique sur la cellule qui clignote</h2>
                    <div className={feedback === 'wrong' ? 'animate-shake' : ''} style={{ display: 'grid', gridTemplateColumns: 'repeat(4, 1fr)', gap: 8, maxWidth: 280 }}>
                        {grid.map((color, i) => (
                            <button key={i} onClick={() => handleCellClick(i)} style={{
                                width: 60, height: 60, borderRadius: 12, border: 'none', background: color, cursor: 'pointer',
                                transition: 'all 0.15s ease', animation: i === changingCell ? 'neuron-pulse 0.8s ease-in-out infinite' : 'none'
                            }} />
                        ))}
                    </div>
                    {feedback && <div style={{ marginTop: 30, fontFamily: 'var(--font-display)', fontSize: '1.5rem', fontWeight: 700, color: feedback === 'correct' ? COLORS.cyan : COLORS.magenta }}>{feedback === 'correct' ? '‚úì Bien vu !' : '‚úó Mauvaise cellule !'}</div>}
                </div>
            );
        };

        const App = () => {
            const [screen, setScreen] = useState('onboarding');
            const [user, setUser] = useState(null);
            const [selectedMode, setSelectedMode] = useState(null);

            useEffect(() => { const savedUser = localStorage.getItem('neural_user'); if (savedUser) { setUser(JSON.parse(savedUser)); setScreen('dashboard'); } }, []);

            const renderGame = () => {
                switch (selectedMode?.id) {
                    case 'memory': return <MemoryGame onBack={() => { setSelectedMode(null); setScreen('dashboard'); }} />;
                    case 'reaction': return <ReactionGame onBack={() => { setSelectedMode(null); setScreen('dashboard'); }} />;
                    case 'pattern': return <PatternGame onBack={() => { setSelectedMode(null); setScreen('dashboard'); }} />;
                    case 'recall': return <RecallGame onBack={() => { setSelectedMode(null); setScreen('dashboard'); }} />;
                    case 'focus': return <FocusGame onBack={() => { setSelectedMode(null); setScreen('dashboard'); }} />;
                    default: return null;
                }
            };

            return (
                <div>
                    {screen === 'onboarding' && <OnboardingScreen onComplete={() => setScreen('auth')} />}
                    {screen === 'auth' && <AuthScreen onAuth={userData => { setUser(userData); setScreen('dashboard'); }} />}
                    {screen === 'dashboard' && <DashboardScreen user={user} onSelectMode={mode => { setSelectedMode(mode); setScreen('game'); }} onLogout={() => { localStorage.removeItem('neural_user'); setUser(null); setScreen('onboarding'); }} />}
                    {screen === 'game' && renderGame()}
                </div>
            );
        };

        ReactDOM.createRoot(document.getElementById('root')).render(<App />);
    </script>
</body>
</html>
